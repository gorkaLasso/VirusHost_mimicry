# taxonomy_enrichment

Taxonomic enrichment for a group of viruses using the set of proteins that are structurally similar to the viral proteins. Viruses are grouped according to the taxonomic division of their host. Taxonomic division enrichment was computed with a hypergeometric test that describes the significance of having k structural neighbors belonging to a particular taxonomic division (out of n total structural neighbors for a group of viruses) given the entire set of structurally solved proteins in the PDB of size N that contains K proteins from the same taxonomic division. To minimize experimental bias of multiple PDB entries for the same protein, structurally solved proteins were mapped to their Uniprot accession codes using SIFTS mapping (https://www.ebi.ac.uk/pdbe/docs/sifts/).

## Table of contents
* [Directories](#Directories)
* [Perl_scripts](#Perl_scripts)
* [Other](#Other)


## Directories

Taxonomy enrichment results for Bacteria-infecting viruses, Human-infecting viruses, Invertebrate-infecting viruses, PlantFungi-infecting viruses and Vertebrate-infecting viruses. Files contained within each directory:

* enrichment_2.5.txt

     Hypergeometric test using all structural mimics

* enrichment_subCluster40_2.5.txt

     Hypergeometric test using a set of structural mimics filtered at 40% sequence identity

* representative_template_space.txt

     Set of structural templates used to infer structurally similar proteins (pdb, pdb_start, pdb_end, uniprot AC, taxonomic division)

* subCluster40_neighbor_space_2.5.txt

     Set of inferred structural mimics filtered at 40% sequence identity

* uniprot_neighbor_space.txt

     Set of inferred structural mimics (uniprot, host taxonomic ID, host name, host taxonomic division, lowest structural alignment score)

## Perl scripts

* 1_identify_templates

     Retrieves all the structural templates to be used to infer structurally similar proteins. Within each directory, the script generates the "representative_template_space_2.5.txt"

* 2_identify_neighbors.pl

     Retrieves all the structural neighbors based on the output file generated by "1_identity_templates.pl"

* 3_hypergeometric.pl

     Performs the hypergeometric test based on the output generated by "2_identify_neighbors.pl" and the structural coverage of the different taxonomic divisions in the PDB as background


* 4_identity_seqBasedTaxClusters.pl

     Filters out the set of structural neighbors and reports only the non-redundant structural neighbors using a sequence filter of 40%

* 5_hypergeometric_seqBasedTaxClusters.pl

     Similar to "3_hypergeometric.pl" but uses low redundancy structural neighbors reported by "4_identity _seqBAsedTaxClusters.pl". As background it uses the structural coverage of the different taxonomic divisions in the PDB, also filtered at 40% sequence identity

## Other
* enrichment_sum_4_manuscript.xlsx

     P-values used to plot enrichments in Figure 1b and 1c
